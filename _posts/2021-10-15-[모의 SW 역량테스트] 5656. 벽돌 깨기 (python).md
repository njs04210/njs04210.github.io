---
## layout: post
## title:  [ëª¨ì˜ SW ì—­ëŸ‰í…ŒìŠ¤íŠ¸] 5656. ë²½ëŒ ê¹¨ê¸°
categories: [SWEA]
comments: true
---

### [ğŸ‘‰ ë¬¸ì œ ë³´ëŸ¬ê°€ê¸°](https://swexpertacademy.com/main/code/problem/problemDetail.do?contestProbId=AWXRQm6qfL0DFAUo)  


#### Key Point
1. ì¬ê·€ë¥¼ í†µí•œ dfsë¡œ ë§ì¶˜ êµ¬ìŠ¬ì˜ ëª¨ë“  ê²½ìš°ì˜ ìˆ˜ë¥¼ êµ¬í•œë‹¤.  
2. êµ¬ìŠ¬ì„ ë§ì¶œ ë•Œë§ˆë‹¤ bfs(break_blocks ë©”ì†Œë“œ)ë¥¼ í†µí•´ ì¡°ê±´ê³¼ ê°™ì´ ì—°ì†í•˜ëŠ” ë¸”ë¡ë“¤ì„ ëª¨ë‘ ê¹¨ëœ¨ë¦°ë‹¤.  
3. êµ¬ìŠ¬ì„ ê¹¬ ë’¤ì—ëŠ” move_blocks ë©”ì†Œë“œë¥¼ í†µí•´ ê³µì¤‘ì— ìˆëŠ” ë¸”ë¡ë“¤ì„ ì•„ë˜ë¡œ ì´ë™ì‹œì¼œ ì¤€ë‹¤.  
4. êµ¬ìŠ¬ì„ në§Œí¼ ê¹¨ë©´ ë‚¨ì•„ìˆëŠ” ë¸”ë¡ë“¤ì˜ ìˆ˜ë¥¼ í™•ì¸í•œë‹¤.  

- ë§ì¶œ ìˆ˜ ìˆëŠ” ëª¨ë“  ê²½ìš°ì˜ ìˆ˜ êµ¬í•˜ê¸° -> DFS ì‚¬ìš©
- ë§ë‹¿ì•„ìˆëŠ” ë¸”ë¡ë“¤ ê°™ì´ ê¹¨ê¸° -> BFS ì‚¬ìš©
- â˜…â˜… dfs í•´ì£¼ê¸° ì „, í˜„ì¬ ë¸”ë¡ ìƒíƒœë¥¼ ë³µì‚¬í•´ë‘¬ì•¼í•œë‹¤.  
ë‹¤ë¥¸ ê²½ìš°ì˜ ìˆ˜ ê¹Œì§€ ëª¨ë‘ ì‚´í”¼ê¸° ìœ„í•´ <u>êµ¬ìŠ¬ ìƒíƒœë¥¼ ì›ìƒë³µêµ¬</u>í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì´ë‹¤! -> copy.deepcopy ì´ìš©

---


```python
from collections import deque
from copy import deepcopy

def move_blocks(a):
    for j in range(w):
        for i in range(h-2, -1, -1):
            if a[i][j] > 0 and a[i+1][j] == 0:
                tmp = a[i][j]
                a[i][j] = 0
                idx = i
                while idx+1 <= h-1 and a[idx+1][j] == 0:
                    idx += 1
                a[idx][j] = tmp

def break_blocks(x, y, a):
    q = deque()
    q.append((x, y, a[x][y]))
    while q:

        x, y, v = q.popleft()
        a[x][y] = 0

        if v == 1: continue # v = 1ì¼ ê²½ìš° ìê¸° ìì‹ ë§Œ ê¹¨ì§„ë‹¤.

        for i in range(4):
            nx, ny = x, y
            for _ in range(v - 1):
                nx += dy[i]
                ny += dx[i]
                if nx < 0 or nx >= h or ny < 0 or ny >= w: continue
                if a[nx][ny] == 0: continue
                q.append((nx, ny, a[nx][ny]))

def dfs(L, a):
    if L == n:
        global answer

        total = 0
        for i in range(h):
            for j in range(w):
                if a[i][j] == 0: continue
                total += 1
        answer = min(total, answer)
        return

    for j in range(w):
        for i in range(h):
            if a[i][j] == 0: continue
            tmp_a = deepcopy(a)
            break_blocks(i, j, a)
            move_blocks(a)
            dfs(L+1, a)
            a = tmp_a
            break # í•˜ë‚˜ì˜ ì—´ì—ì„œ ë§¨ ìœ„ì˜ êµ¬ìŠ¬ë§Œ ê¹¨ì•¼í•˜ë¯€ë¡œ

    dfs(n, a) # ë§ì¶œ êµ¬ìŠ¬ì´ ì—†ëŠ” ê²½ìš° ë°”ë¡œ ì¢…ë£Œì¡°ê±´ìœ¼ë¡œ ì´ë™

dx, dy = [1,0,-1,0], [0,1,0,-1]

T = int(input())
for test_case in range(1, T + 1):
    n, w, h = map(int, input().split())
    MAP = [list(map(int, input().split())) for _ in range(h)]
    answer = 2147000000

    dfs(0, MAP)

    print(f'#{test_case} {answer}')
```